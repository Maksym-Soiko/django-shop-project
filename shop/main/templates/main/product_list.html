{% extends 'main/base.html' %} 
{% load static %} 
{% load shop_tags %} 
{% block title %} 
{% if search_query %} Пошук: {{ search_query }} {% elif category %} {{ category.name }} {% else %} Каталог товарів {% endif %} 
{% endblock %} 
{% block content %}

<div class="mb-4">
  <div class="inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-teal-50 to-emerald-50 rounded-full border-2 border-teal-200/60 shadow-md hover:shadow-lg transition-shadow duration-300">
    <i class="fas fa-hand-sparkles text-teal-600"></i>
    <p class="text-base lg:text-lg font-semibold bg-gradient-to-r from-teal-600 to-emerald-600 bg-clip-text text-transparent">
      {% user_greeting user %}
    </p>
  </div>
</div>

{% include 'main/search_form.html' %}

{% if not request.GET.page or request.GET.page == '1' %}
<div class="mb-10 flex justify-start">
  <button
    id="togglePopularBtn"
    type="button"
    class="inline-flex items-center justify-center gap-2 px-5 py-2 bg-gradient-to-r from-teal-600 to-emerald-600 text-white rounded-xl shadow-md hover:shadow-lg transition transform hover:-translate-y-0.5 duration-150 cursor-pointer font-medium"
  >
    <i class="fas fa-fire text-orange-400"></i>
    <span id="btnText">Показати найпопулярніші товари</span>
    <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevronIcon"></i>
  </button>
</div>

<div id="popularProductsSection" class="hidden transition-all duration-500 mb-10">
  {% show_popular_products 4 %}
</div>
{% endif %}

<div class="mb-10">
  <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
    <div>
      <h1 class="text-4xl font-bold bg-gradient-to-r from-teal-600 via-emerald-600 to-green-600 bg-clip-text text-transparent mb-2">
        {% if search_query %} Результати пошуку {% elif category %} {{category.name}} {% else %} Каталог товарів {% endif %}
      </h1>
      <p class="text-gray-600">Знайдіть ідеальний товар для себе</p>
    </div>

    {% if products %} {% include 'main/components/sort_buttons.html' %} {% endif %}
  </div>
</div>

<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
  {% for product in products %} {% include 'main/components/product_card.html'%}
  {% empty %}
  <div class="col-span-full flex flex-col items-center justify-center py-20 text-center">
    <div class="w-28 h-28 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-6">
      <i class="fas fa-question-circle text-5xl text-gray-300"></i>
    </div>

    <h3 class="text-2xl font-bold text-gray-800 mb-2">Товари не знайдено</h3>
    <p class="text-gray-600 max-w-md mb-6">
      На жаль, за вашим запитом нічого не знайдено. Спробуйте наступні дії, щоб
      знайти потрібний товар:
    </p>

    <ul class="text-left space-y-2 mb-6 max-w-md">
      <li class="flex items-start gap-3">
        <span class="text-teal-600 mt-1"><i class="fas fa-filter"></i></span>
        <span>Перевірте фільтри та параметри сортування.</span>
      </li>
      <li class="flex items-start gap-3">
        <span class="text-teal-600 mt-1"><i class="fas fa-search"></i></span>
        <span>Спробуйте інші ключові слова в пошуку.</span>
      </li>
      <li class="flex items-start gap-3">
        <span class="text-teal-600 mt-1"><i class="fas fa-fire"></i></span>
        <span>Показати популярні товари.</span>
      </li>
    </ul>

    <div class="flex flex-col sm:flex-row gap-3">
      <a
        href="{% url 'main:product_list' %}"
        class="px-5 py-3 bg-white border border-gray-200 text-gray-700 rounded-xl shadow-sm hover:shadow-md"
      >
        Очистити фільтри
      </a>
      <a
        href="{{ request.path }}?sort=popular"
        class="px-5 py-3 bg-gradient-to-r from-teal-600 to-emerald-600 text-white rounded-xl shadow-md hover:shadow-lg"
      >
        Показати популярні
      </a>
      <a
        href="{% url 'main:product_list' %}"
        class="px-5 py-3 bg-gray-100 text-gray-800 rounded-xl hover:bg-gray-200"
      >
        Повернутися до каталогу
      </a>
    </div>

    <p class="text-sm text-gray-500 mt-6 max-w-md">
      Якщо ви не знайшли потрібного товару — зверніться до нас або спробуйте
      інші параметри пошуку.
    </p>
  </div>
  {% endfor %} {% include 'main/pagination.html' %}
</div>

{% endblock %}